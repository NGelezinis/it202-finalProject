<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>repl.it</title>
    
    <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
    <script src="https://unpkg.com/dexie@latest/dist/dexie.js"></script>
      
    <style>
      #template {display:none;}
      #template2 {display:none;}
      #template3 {display:none;}
    </style>
      
    <script>
          //
          // Define your database
          //
          var db = new Dexie("favorite_games_database");
          db.version(1).stores({
              games: 'id, name'
          });
    </script>


  </head>
  <body>
    
    <!--  -->
    <header class="mdc-top-app-bar">
      <div class="mdc-top-app-bar__row">
        <section class="mdc-top-app-bar__section" role="toolbar">
          <button type="button" id="home">Home</button> 
          <button type="button" id="page1">Page1</button> 
          <button type="button" id="page2">Page2</button> 
        </section>
      </div>
    </header>
    <div class="mdc-top-app-bar--fixed-adjust"><div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <p id="demo"></p>

    <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
    
    <div id="currentPage" href=""></div>
        
    <div class="mdc-text-field">
      <input type="text" id="search-text" class="mdc-text-field__input">
      <label class="mdc-floating-label" for="my-text-field">Search</label>
      <div class="mdc-line-ripple"></div>
    </div>
    <button type="button" id = "buttonSearch" class="mdc-button">submit</button>
        
    <div id="info">
        
    </div>
    <button data-mdc-auto-init="MDCIconButtonToggle" id="template3" name="" value="off"
      class="mdc-icon-button"
      aria-label="Add to favorites"
      aria-hidden="true"
      aria-pressed="false"
      onclick="fav(id, name, value)">
      <i class="material-icons mdc-icon-button__icon mdc-icon-button__icon--on">star</i>
      <i class="material-icons mdc-icon-button__icon">star_border</i>
    </button>
        <script>
          function fav(num, word, pressed) {
            if($("#" + num).find("i.mdc-icon-button__icon--on").css("display") == "none"){
              db.games.put({id:num,name:word});
              //console.log(num);
            }
            else{
              db.games.delete(num);
              //console.log(word);
            }
          }
        </script>
        
    <p id="save"></p>
    <a id="template2"></a>
    <a id="template" target="_blank">Steam link</a>
    <script type="text/javascript">
      
      function initSearch() {
        //document.getElementById("#info").innerHTML = "";
        $("#info").append('<h1>Searching for "' + $("#search-text").val() + '" 100 results</h1>');
        var lookFor;
        lookFor = $("#search-text").val();
        var url = "https://api.steampowered.com/ISteamApps/GetAppList/v2/?key=FBE137D7F9891331E38F1AEF8B394271&format=json";  
        $.ajax({
          url: url,
          method: 'GET',
          data: {
            "$limit" : 100
          }
        }).done(function(result) {
        //console.log(result);

        // loop through array of results
          $.each(result.applist, function(i,v) {
              
              var i = 0;
              var j = 0;
              var endpt = v.length;
              while(i < endpt && j < 100){
                //console.log(v[i]);
                if(v[i].name.includes(lookFor)){
                  var url2="https://store.steampowered.com/app/"
                  url2 += v[i].appid + "/" + v[i].name + "/"
                  var clone = $("#template").clone();
                  var clone2 = $("#template2").clone();
                  var clone3 = $("#template3").clone();
                  clone.attr("id",v[i].name);
                  clone2.attr("id",v[i].name);
                  clone3.attr("id",v[i].appid);
                  clone3.attr("name",v[i].name);
                  clone.attr("href", url2);
                  $(clone2).append(v[i].name)
                  //$(clone2).append(v[i].appid)
                  $("#info").append(clone2);
                  $("#info").append(clone);
                  $("#info").append(clone3);
                  $("#info").append('<br>');
                  j++;
                  //window.mdc.autoInit();
                  /*
                  $(document).ready(function() {
                    console.log(v[i].appid)
                    clone3.addEventListener("click", function() {
                      console.log("detail");
                    });
                });
                */
                }
                i++;
              }
              window.mdc.autoInit();
          });
            
        }).fail(function(err) {
          throw err;
        });
          
      }
      
    </script>
    <script type="text/javascript">



    // wait til the document is ready
    $(document).ready(function () {
      $( "#currentPage" ).load( "home.html" );

      // initializes all elements with the data-mdc-auto-init attribute
      window.mdc.autoInit();
        
        /*
      $("button").on("click", function(e) {
          if ($(this).find("i.mdc-icon-button__icon--on").css("display") == "none") {
            //console.log(listinfo[this.id]);
            console.log("7");
            //db.library.delete(listinfo[this.id]);
          } else {
            //db.library.put({info:listinfo[this.id],xCoord:xlist[this.id],yCoord:ylist[this.id]});
          }
        });
        //window.mdc.autoInit();
*/
      // creating a var reference just to save code later


      // when menu icon is click, toggle drawer open property
      
      $("#buttonSearch").on("click", initSearch)
      
        
      $("#home").on("click", function(){
        $( "#currentPage" ).load( "home.html" );
      });
        
      $("#page1").on("click", function(){
        $( "#currentPage" ).load( "page1.html" );
      });
        
      $("#page2").on("click", function(){
        $( "#currentPage" ).load( "page2.html" );
      });

      //$( "#currentPage" ).load( $(this).attr("data-page") );


    })
    </script>
  
  </body>
</html>